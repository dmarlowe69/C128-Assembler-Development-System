;*********************************;;         CROSSREF64;      CROSSREF.C64 V072882; DUMP CROSSREF FROM ASSEMBLER64; (C) 1982 BY COMMODORE MACHINES;;  DOCUMENTED BY DENTON MARLOWE;;********************************; PAGE $0000 EQUATES;********************************ADRAY1=$0003ADRAY2=$0005CHARAC=$0007ENDCHR=$0008TRMPOS=$0009VERCK =$000ACOUNT =$000BDIMFLG=$000CVALTYP=$000DINTFLG=$000EGARBFL=$000FSUBFLG=$0010INPFLG=$0011TANSGN=$0012CHANNL=$0013LINNUM=$0014TEMPPT=$0016LASTPT=$0017TEMPST=$0019;********************************; POINTERS;********************************XRLPNT = $04XRFPNT = $06;********************************; EXTERNAL ADDRESS EQUATES;********************************SCREG=$D011;********************************; EXTERNAL ADDRESS EQUATES;********************************BASSFT=$4D37 ;$E386 ;RETURN TO BASICPRTCHR=$C72D ;$E716 ;PRINT CHAR TO SCREEN;********************************; EXTERNAL ADDRESS EQUATES;********************************SETLFS=$FFBASETNAM=$FFBDOPEN=$FFC0CLOSE=$FFC3CHKIN=$FFC6CHKOUT=$FFC9CLRCHN=$FFCCCHRIN=$FFCFCHROUT=$FFD2;********************************; EXTERNAL ADDRESS EQUATES;********************************CURON  = $CD6FCUROFF = $CD9F;SETBNK = $FF68 ;JSETBNKCLOSEA = $FF4A ;CLOSE-ALL CLALL  = $FFE7 ;CLEAR ALL I/O;PRIMM  = $FF7D ;PRINTIMMEDIATE;*********************************;; CROSSREF64 ENTRY POINT;;*********************************XXREF  JSR SAVZPG       JMP XX0889;********************************; ZERO PAGE STORAGE;********************************ZPGSTR .BYTE $AA,$AA,$AA,$AA,$AA,$AA       .BYTE $AA,$AA,$AA,$AA,$AA,$AA       .BYTE $AA,$AA,$AA,$AA,$AA,$AA       .BYTE $AA,$AA,$AA,$AA,$AA,$AA;********************************; ;********************************DEVIN  .BYTE $AA ;XX082D INPUT DEVICEXX082E .BYTE $AAXX082F .BYTE $AAPRTFLG .BYTE $AA ;XX0830 HARDCOPY FLAGXX0831 .BYTE $AAXX0832 .BYTE $AA;********************************;;********************************XX0833 .BYTE $AAXX0834 .BYTE $AA       .BYTE $AA,$AA,$AA,$AA       .BYTE $AA,$AA,$AA,$AA       .BYTE $AA,$AA,$AA,$AA;********************************;;********************************XX0841 .BYTE $AA       .BYTE $AA,$AA;********************************; CROSSREF FILENAME BUFFER;********************************XRFFNM .BYTE $AA ;XX0844       .BYTE $AA,$AA,$AA,$AA;********************************;;********************************XX0849 .BYTE $AA       .BYTE $AA,$AA,$AA,$AA,$AA       .BYTE $AA,$AA,$AA,$AA,$AA;********************************;;********************************XX0854 .BYTE $AAXX0855 .BYTE $AAXX0856 .BYTE $AAXX0857 .BYTE $AA;********************************;;********************************XX0858 .BYTE $AA       .BYTE $AA,$AA,$AA,$AA,$AA       .BYTE $AA,$AA,$AA,$AA,$AA       .BYTE $AA,$AA,$AA,$AA,$AA       .BYTE $AA,$AA,$AA,$AA,$AA       .BYTE $AA,$AA,$AA,$AA,$AA       .BYTE $AA,$AA,$AA,$AA,$AA       .BYTE $AA,$AA,$AA,$AA,$AA       .BYTE $AA,$AA,$AA,$AA,$AA       .BYTE $AA,$AA,$AA,$AA,$AA       .BYTE $AA,$AA,$AA;********************************;;********************************XX0889 CLD        LDA #$00       STA XX0833       STA XX0831       STA XX0832       INC XX0831       STA DEVIN       STA $18       STA $19;********************************; OPEN I/O TO KEYBOARD;********************************       LDA #$05       LDX #$00       LDY #$FF       JSR SETLFS       LDA #$00       JSR SETNAM              LDA #$00     ;LOAD INTO BANK 1       LDX #$00     ;PROGRAM IN BANK 0       JSR SETBNK                     JSR OPEN;********************************; OPEN I/O TO SCREEN;********************************       LDA #$01       LDX #$03       LDY #$FF       JSR SETLFS       LDA #$00       JSR SETNAM              LDA #$00     ;LOAD INTO BANK 1       LDX #$00     ;PROGRAM IN BANK 0       JSR SETBNK              JSR OPEN;********************************;;********************************       LDA #$93 ;SCREEN CLEAR       JSR CHROUT;********************************; SET INPUT CHANNEL TO KEYBOARD;********************************       LDX #$05       STX DEVIN       JSR CHKIN;********************************; PROMPT FOR HARDCOPY;********************************       LDA #>MESSG ;$0D       LDY #<MESSG ;$13       JSR XX0C7E;********************************; GET RESPONSE;********************************       JSR CHRIN       LDX #$00       STX PRTFLG       CMP #$4E      ;'N'       BEQ XX08E3       LDX #$80;********************************;;********************************XX08E3 STX PRTFLG;********************************; OPEN I/O TO PRINTER;********************************       LDA #$04       TAX        LDY #$FF       JSR SETLFS       LDA #$00       JSR SETNAM              LDA #$00     ;LOAD INTO BANK 1       LDX #$00     ;PROGRAM IN BANK 0       JSR SETBNK              JSR OPEN;********************************;;********************************       JSR SCROFF       LDA #$0D       JSR CHROUT;********************************; OPEN I/O TO DISK STATUS;********************************       LDA #$07       LDX #$08       LDY #$0F       JSR SETLFS;********************************; FILENAME = 'I0' FOR INIT DRIVE;********************************       LDA #$49      ;'I'       STA XX0857       LDA #$30      ;'0'       STA XX0858;       LDX #<XX0857 ;#$57      ;'W'       LDY #>XX0857 ;#$08       LDA #$02       JSR SETNAM       LDA #$00     ;LOAD INTO BANK 1       LDX #$00     ;PROGRAM IN BANK 0       JSR SETBNK              JSR OPEN;********************************;;********************************       LDA #$00       LDY #$02       STA XX082E       STY XX082F;********************************; LOAD FILENAME BUFFER FROM MASTER; 0:XRFF0000,S,W;********************************       LDY #$00XX0929 LDA XRFF00,Y ;XX0D4B       STA XRFFNM,Y ;XX0844       INY        CPY #$0E       BNE XX0929       JSR XX0CE4;********************************; CLEAR I/O CHANNEL;********************************       JSR CLRCHN;********************************; OPEN CROSS REFERNCE FILE;********************************       LDA #$08       TAX        TAY        JSR SETLFS       LDX #<XRLL00 ;$3D       LDY #>XRLL00 ;$0D       LDA #$0E     ;14 CHARS       JSR SETNAM              LDA #$00     ;LOAD INTO BANK 1       LDX #$00     ;PROGRAM IN BANK 0       JSR SETBNK              JSR OPEN;********************************;;********************************       JSR XX0C25XX0950 LDA $18       LDY $19       STA $16       STY $17       CLC        LDA $16       ADC XX082E       STA $18       LDA $17       ADC XX082F       STA $19;       LDA #<XX0DAA ;#$AA       LDY #>XX0DAA ;#$0D       STA XRLPNT       STY XRLPNT+1;       LDA #<XX15AA ;#$AA       LDY #>XX15AA ;#$15       STA XRFPNT       STY XRFPNT+1;       LDA XRLPNT       LDY XRLPNT+1       STA $0C       STY $0D       LDY #$00XX0981 TYA        STA ($0C),Y       INC $0C       BNE XX098A       INC $0DXX098A LDA $0D       CMP XRFPNT+1       BNE XX0981       LDA $0C       CMP XRFPNT       BNE XX0981       LDY #$0DXX0998 LDA XRFFNM,Y       STA XX0834,Y       DEY        BPL XX0998       LDA #$52      ;'R'       STA XX0841       LDX #$04XX09A8 INC XX0849,X       LDA XX0849,X       CMP #$3A      ;':'       BNE XX09BA       LDA #$30      ;'0'       STA XX0849,X       DEX        BNE XX09A8;XX09BA LDA #$09       LDX #$08       TAY        JSR SETLFS       LDX #<XX0834 ;#$34      ;'4'       LDY #>XX0834 ;#$08       LDA #$0E       JSR SETNAM              LDA #$00     ;LOAD INTO BANK 1       LDX #$00     ;PROGRAM IN BANK 0       JSR SETBNK              JSR OPEN       JSR XX0C25;       LDA #$0A       LDX #$08       TAY        JSR SETLFS       LDX #<XRFFNM ;#$44      ;'D'       LDY #>XRFFNM ;#$08       LDA #$0E       JSR SETNAM              LDA #$00     ;LOAD INTO BANK 1       LDX #$00     ;PROGRAM IN BANK 0       JSR SETBNK              JSR OPEN       JSR XX0C25;       LDA #$00       STA $15XX09EC LDX #$09       CPX DEVIN       BEQ XX09FE       STX DEVIN       JSR CLRCHN;       LDX #$09       JSR CHKIN;XX09FE JSR CHRIN       STA $08       JSR CHRIN       STA $09       JSR CHRIN       STA $0A       JSR CHRIN;       STA $0B       LDA $90       STA $15       SEC        LDA $08       SBC $16       LDA $09       SBC $17       BCC XX0A2B       LDA $08       SBC $18       LDA $09       SBC $19       BCC XX0A4D;XX0A2B JSR CLRCHN       LDX #$0A       STX DEVIN       JSR CHKOUT;       LDA $08       JSR CHROUT       LDA $09       JSR CHROUT       LDA $0A       JSR CHROUT       LDA $0B       JSR CHROUT       JMP XX0ABB;********************************;;********************************XX0A4D SEC        LDA $08       SBC $16       STA $0C       LDA $09       SBC $17       ASL $0C       ROL A       ASL $0C       ROL A       STA $0D       CLC        LDA $0C       ADC XRLPNT       STA $0C       LDA $0D       ADC XRLPNT+1       STA $0D       LDY #$01       LDA ($0C),Y       BNE XX0A89       DEY        LDA XRFPNT       STA ($0C),Y       INY        LDA XRFPNT+1       STA ($0C),Y       INY        LDA XRFPNT       STA ($0C),Y       INY        LDA XRFPNT+1       STA ($0C),Y       BNE XX0AA0XX0A89 DEY        LDA ($0C),Y       STA $0E       INY        LDA ($0C),Y       STA $0F       LDA XRFPNT+1       STA ($0C),Y       STA ($0E),Y       DEY        LDA XRFPNT       STA ($0C),Y       STA ($0E),YXX0AA0 LDY #$01       LDA #$00       STA (XRFPNT),Y       INY        LDA $0A       STA (XRFPNT),Y       INY        LDA $0B       STA (XRFPNT),Y       CLC        LDA XRFPNT       ADC #$04       STA XRFPNT       BCC XX0ABB       INC XRFPNT+1XX0ABB LDA $15       BNE XX0AC2       JMP XX09EC;********************************;;********************************XX0AC2 LDA #$09       JSR CLOSE       LDA #$0A       JSR CLOSE;********************************;;********************************XX0ACC LDY #$01       LDA (XRLPNT),Y       LDY #$03       CMP (XRLPNT),Y       BNE XX0AE4       LDY #$00       LDA (XRLPNT),Y       LDY #$02       CMP (XRLPNT),Y       BNE XX0AE4       LDA #$2A      ;'*'       BNE XX0AE6XX0AE4 LDA #$20      ;' 'XX0AE6 JSR PCHAR       JSR XX0BF6       LDY #$06XX0AEE JSR XX0B8C       JSR PCHAR       DEY        BNE XX0AEE       JSR XX0BF6       LDA #$24      ;'$'       JSR PCHAR       JSR XX0B8C       JSR XX0CA9       JSR XX0B8C       LDX $90       STX $14       JSR XX0CA9       LDY #$02       LDA (XRLPNT),Y       TAX        INY        LDA (XRLPNT),Y       STX $0C       STA $0D       BNE XX0B49XX0B1D JSR XX0BF6       LDY #$02       LDA ($0C),Y       TAX        INY        LDA ($0C),Y       JSR XX0BA1       LDY #$01       LDA ($0C),Y       TAX        BEQ XX0B50       DEY        LDA ($0C),Y       STA $0C       STX $0D       DEC XX0854       BNE XX0B1D       JSR XX0CD4       LDX #$07XX0B43 JSR XX0BF3       DEX        BNE XX0B43XX0B49 LDY #$0A       STY XX0854       BNE XX0B1DXX0B50 JSR XX0CD4       LDA $14       BNE XX0B76       CLC        LDA XRLPNT       ADC #$04       STA XRLPNT       BCC XX0B62       INC XRLPNT+1XX0B62 SEC        LDA XRLPNT       SBC #<XX15AA ;#$AA       LDA XRLPNT+1       SBC #>XX15AA ;#$15       BCS XX0B70       JMP XX0ACC;********************************;;********************************XX0B70 JSR CLRCHN       JMP XX0950;********************************;;********************************XX0B76 JSR XX0CC1       JSR XX0CC1       LDA #$04       JSR CLOSE       LDA #$08       JSR CLOSE       JSR CLRCHN       JMP XX0C75;********************************; SET INPUT TO CHANNEL 8 AND READ IN CHAR;********************************XX0B8C LDX #$08       CPX DEVIN       BEQ XX0B9E       STX DEVIN       JSR CLRCHN       LDX #$08       JSR CHKINXX0B9E JMP CHRIN;********************************;;********************************XX0BA1 STX $10       STA $11       LDA #$00       STA XX0855       LDX #$04       STX XX0856XX0BAF LDX XX0856       LDY #$30      ;'0'       BNE XX0BBAXX0BB6 INY        STY XX0855XX0BBA SEC        LDA $10       SBC XX0D73,X       STA $10       LDA $11       SBC XX0D78,X       STA $11       BCS XX0BB6       LDA $10       ADC XX0D73,X       STA $10       LDA $11       ADC XX0D78,X       STA $11       TYA        CMP #$30      ;'0'       BNE XX0BE5       LDY XX0855       BNE XX0BE5       LDA #$20      ;' 'XX0BE5 JSR PCHAR       DEC XX0856       BPL XX0BAF       RTS ;********************************; OUTPUT CR;********************************PRTCR LDA #$0D       JMP PCHAR;********************************;;********************************XX0BF3 JSR XX0BF6XX0BF6 LDA #$20      ;' ';********************************; OUTPUT CHAR TO SCREEN OR PRINTER;********************************PCHAR  STX $12       STY $13       PHA        BIT PRTFLG       BPL XX0C1C       LDA DEVIN       CMP #$04       BEQ XX0C14       JSR CLRCHN       LDX #$04       STX DEVIN       JSR CHKOUTXX0C14 PLA        PHA        JSR CHROUT       JMP XX0C1F;********************************; PRINT CHAR TO SCREEN;********************************XX0C1C JSR PRTCHR;********************************; RESTORE A,X AND Y;********************************XX0C1F PLA        LDY $13       LDX $12       RTS ;********************************; DISK I/O ERROR;********************************XX0C25 JSR CLRCHN       LDX #$07       STX DEVIN       JSR CHKIN       JSR CHRIN       STA $02       JSR CHRIN       STA $03       CMP #$30      ;'0'       BNE XX0C4C       LDA $02       CMP #$30      ;'0'       BNE XX0C4CXX0C44 JSR CHRIN       CMP #$0D       BNE XX0C44       RTS ;********************************; PRINT DISK ERROR;********************************XX0C4C LDX #$01XX0C4E LDA $02,X       STA XX0857,X       DEX        BPL XX0C4E       LDY #$02XX0C58 STY $13       JSR CHRIN       CMP #$0D       BEQ XX0C69       LDY $13       STA XX0857,Y       INY        BNE XX0C58XX0C69 LDA #$8D       STA XX0857,Y       LDA #>XX0857 ;#$08       LDY #<XX0857 ;#$57      ;'W'       JSR XX0C7EXX0C75 JSR SCRON       JSR RETZPG       JMP BASSFT;********************************;;********************************XX0C7E PHA        LDA #$01       CMP DEVIN       BEQ XX0C95       TYA        PHA        JSR CLRCHN       LDX #$01       STX DEVIN       JSR CHKOUT       PLA        TAY ;********************************; OUTPUT STRING; HIGH BYTE ADDRESS IN A; LOW BYTE ADDRESS IN Y;********************************XX0C95 PLA        STA $11       STY $10       LDY #$00XX0C9C LDA ($10),Y       INY        PHA        AND #$7F       JSR CHROUT       PLA        BPL XX0C9C       RTS ;********************************;;********************************XX0CA9 PHA        LSR A       LSR A       LSR A       LSR A       JSR XX0CB4       PLA        AND #$0FXX0CB4 CLC        ADC #$30      ;'0'       CMP #$3A      ;':'       BMI XX0CBE       CLC        ADC #$07XX0CBE JMP PCHAR;********************************;;********************************XX0CC1 JSR PRTCR       INC XX0833       LDA XX0833       CMP #$42      ;'B'       BNE XX0CC1       LDA #$00       STA XX0833       RTS ;********************************;;********************************XX0CD4 JSR PRTCR       INC XX0833       LDA XX0833       CMP #$3C      ;'<'       BNE XX0D12       JSR XX0CC1XX0CE4 JSR XX0CD4       TXA        PHA ;********************************; PRINT PAGE BANNER;********************************       LDX #$00XX0CEB LDA BANNER,X       BEQ XX0CF6 ; ZERO BYTE END OF STRING       JSR PCHAR       INX        ; INC CHAR POINTER       BNE XX0CEB;XX0CF6 LDX XX0831       LDA XX0832       JSR XX0BA1       INC XX0831       BNE XX0D07       INC XX0832XX0D07 JSR XX0CD4       JSR XX0CD4       JSR XX0CD4       PLA        TAX XX0D12 RTS ;********************************;;********************************;XX0D13MESSG  .BYTE $0DXX0D14 .BYTE 'CROSS REFERENCE'XX0D23 .BYTE $0DXX0D24 .BYTE $0DXX0D25 .BYTE $0DXX0D26 .BYTE 'HARD COPY (CR/Y OR N)?';********************************;;********************************XX0D3C .BYTE $A0;********************************; CROSSREF FILE MASTER NAME;********************************XRLL00 .BYTE '0:XRLL0000,S,R' ;XX0D3D;********************************; CROSSREF FILE MASTER NAME;********************************XRFF00 .BYTE '0:XRFF0000,S,W' ;XX0D4B;********************************;;********************************BANNER .BYTE 'CROSS REFERENCE......PAGE'       .BYTE $00;********************************; LOW BYTE 10'S DIGIT; $0001 = 1; $000A = 10; $0064 = 100; $03E8 = 1000; $2710 = 10000;********************************XX0D73 .BYTE $01 ;1       .BYTE $0A ;10       .BYTE $64 ;100       .BYTE $E8 ;1000       .BYTE $10 ;10000;********************************; HIGH BYTE 10'S DIGIT;********************************XX0D78 .BYTE $00 ;1       .BYTE $00 ;10       .BYTE $00 ;100       .BYTE $03 ;1000       .BYTE $27 ;10000;********************************; IF PRINTING, TURN SCREEN OFF;********************************SCROFF LDA PRTFLG       BPL XX0D8A       LDA SCREG       AND #$EF       STA SCREGXX0D8A RTS ;********************************; TURN SCREEN ON;********************************SCRON  LDA SCREG       ORA #$10       STA SCREG       RTS ;********************************; SAVE ZEROPAGE FROM $02-$1A;********************************SAVZPG LDX #$18XX0D96 LDA $02,X       STA ZPGSTR,X       DEX        BPL XX0D96       RTS ;********************************; RESTORE ZEROPAGE FROM $02-$1A;********************************RETZPG LDX #$18XX0DA1 LDA ZPGSTR,X       STA $02,X       DEX        BPL XX0DA1       RTS ;********************************;;********************************XX0DAA=*;********************************;;*********************************=*+$0800;********************************;;********************************XX15AA=*;********************************.END